data:
    training:
        dataset:
            name: CelebA
            mean: [0.5084, 0.4224, 0.3768]
            std: [0.3048, 0.2824, 0.2808]
            transform:
                features:
                    name: Compose
                    kwargs: {}
                    transforms:
                        - name: PILToTensor
                          kwargs: {}
                        - name: CenterCrop
                          kwargs:
                              size: [178, 178]
                        - name: Resize
                          kwargs:
                              size: [128, 128]
                        - name: ToDtype
                          kwargs:
                              dtype: float32
                              scale: true
                        - name: Normalize
                          kwargs:
                              mean: [0.5084, 0.4224, 0.3768]
                              std: [0.3048, 0.2824, 0.2808]
                target: null
            kwargs:
                use_download: false
                types_target_tv: []
                use_features_as_target: true
        dataloader:
            kwargs:
                batch_size: 128
                shuffle: true
                pin_memory: true
    validation:
        dataset:
            name: CelebA
            mean: [0.5084, 0.4224, 0.3768]
            std: [0.3048, 0.2824, 0.2808]
            transform:
                features:
                    name: Compose
                    kwargs: {}
                    transforms:
                        - name: PILToTensor
                          kwargs: {}
                        - name: CenterCrop
                          kwargs:
                              size: [178, 178]
                        - name: Resize
                          kwargs:
                              size: [128, 128]
                        - name: ToDtype
                          kwargs:
                              dtype: float32
                              scale: true
                        - name: Normalize
                          kwargs:
                              mean: [0.5084, 0.4224, 0.3768]
                              std: [0.3048, 0.2824, 0.2808]
                target: null
            kwargs:
                use_download: false
                types_target_tv: []
                use_features_as_target: true
        dataloader:
            kwargs:
                batch_size: 128
                shuffle: false
                pin_memory: true
    test:
        dataset:
            name: CelebA
            mean: [0.5084, 0.4224, 0.3768]
            std: [0.3048, 0.2824, 0.2808]
            transform:
                features:
                    name: Compose
                    kwargs: {}
                    transforms:
                        - name: PILToTensor
                          kwargs: {}
                        - name: CenterCrop
                          kwargs:
                              size: [178, 178]
                        - name: Resize
                          kwargs:
                              size: [128, 128]
                        - name: ToDtype
                          kwargs:
                              dtype: float32
                              scale: true
                        - name: Normalize
                          kwargs:
                              mean: [0.5084, 0.4224, 0.3768]
                              std: [0.3048, 0.2824, 0.2808]
                target: null
            kwargs:
                use_download: false
                types_target_tv: []
                use_features_as_target: true
        dataloader:
            kwargs:
                batch_size: 128
                shuffle: false
                pin_memory: true
model:
    name: VAEGaussian
    shape_input: [3, 128, 128]
    kwargs:
        num_channels_out_encode: 4096
        num_channels_latent: 64
        shape_input_decoder: [1024, 2, 2]
        name_encoder: CNN2dEncoder
        kwargs_encoder:
            shape_input: [3, 128, 128]
            nums_channels_hidden: [32, 64, 128, 256, 512]
            num_channels_out: 1024
            kwargs_block:
                shape_kernel_conv: [3, 3]
                shape_kernel_pool: null
                name_layer_act: LeakyReLU
                name_layer_norm: BatchNorm2d
                name_layer_pool: null
                kwargs_conv:
                    padding: 1
                    stride: 2
                kwargs_pool: {}
        name_decoder: CNN2dDecoder
        kwargs_decoder:
            shape_input: [1024, 2, 2]
            nums_channels_hidden: [512, 256, 128, 64, 32]
            num_channels_out: 3
            kwargs_block:
                shape_kernel_conv: [3, 3]
                shape_kernel_pool: null
                name_layer_act: LeakyReLU
                name_layer_norm: BatchNorm2d
                name_layer_pool: null
                kwargs_conv:
                    padding: 1
                    stride: 2
                    output_padding: 1
                kwargs_pool: {}
        use_normalize: true
        kwargs_normalize:
            mean: [0.5084, 0.4224, 0.3768]
            std: [0.3048, 0.2824, 0.2808]
measurers:
    training:
        - name: Select
          kwargs:
              key: "prediction"
              name_module: SmoothL1Loss
              kwargs_module:
                  beta: 1.0
        - name: ELBOGaussian
          kwargs: {}
    validation:
        - name: Select
          kwargs:
              key: "prediction"
              name_module: SmoothL1Loss
              kwargs_module:
                  beta: 1.0
        - name: ELBOGaussian
          kwargs: {}
        - name: Select
          kwargs:
              key: "prediction"
              name_module: FrechetInceptionDistance
              kwargs_module:
                  use_unnormalize: true
                  kwargs_unnormalize:
                      mean: [0.5084, 0.4224, 0.3768]
                      std: [0.3048, 0.2824, 0.2808]
                  feature: 64
                  normalize: true
                  reset_real_features: false
    test:
        - name: Select
          kwargs:
              key: "prediction"
              name_module: SmoothL1Loss
              kwargs_module:
                  beta: 1.0
        - name: ELBOGaussian
          kwargs: {}
        - name: Select
          kwargs:
              key: "prediction"
              name_module: FrechetInceptionDistance
              kwargs_module:
                  use_unnormalize: true
                  kwargs_unnormalize:
                      mean: [0.5084, 0.4224, 0.3768]
                      std: [0.3048, 0.2824, 0.2808]
                  feature: 64
                  normalize: true
                  reset_real_features: false
criterion:
    name: SumWeighted
    modules:
        - name: Select
          kwargs:
              key: "prediction"
              name_module: SmoothL1Loss
              kwargs_module:
                  beta: 1.0
        - name: ELBOGaussian
          kwargs: {}
    kwargs:
        weights: [1.0, 1.0e-2]
training:
    num_epochs: 20
    optimizer:
        name: Adam
        kwargs:
            lr: 3.0e-4
            weight_decay: 1.0e-3
    scheduler:
        name: SequentialLR
        dynamic:
        schedulers:
            - name: LinearLR
              kwargs:
                  start_factor: 0.333
                  end_factor: 1.0
                  total_iters: 5
            - name: ExponentialLR
              kwargs:
                  gamma: 0.9
        kwargs:
            milestones: [5]
    use_amp: true
    early_stopping:
        patience: 10
logging:
    tqdm:
        frequency: 10
    tensorboard:
        frequency: 1
    checkpoint:
        frequency: 10
